// Payload Generation Types

export type ShellLanguage = 
    | 'bash' 
    | 'sh'
    | 'python' 
    | 'python3'
    | 'perl' 
    | 'php' 
    | 'ruby' 
    | 'powershell' 
    | 'cmd'
    | 'netcat' 
    | 'ncat'
    | 'java' 
    | 'groovy'
    | 'nodejs'
    | 'csharp'
    | 'go'
    | 'rust'
    | 'lua'
    | 'awk'
    | 'telnet'
    | 'socat';

export type ShellType = 'reverse' | 'bind';

export type EncodingType = 
    | 'base64' 
    | 'hex' 
    | 'url' 
    | 'unicode'
    | 'rot13'
    | 'xor'
    | 'double-url'
    | 'html'
    | 'utf7'
    | 'utf16';

export interface ShellConfig {
    language: ShellLanguage;
    type: ShellType;
    lhost: string;
    lport: number;
    rhost?: string;  // For bind shells
    rport?: number;
    options?: ShellOptions;
}

export interface ShellOptions {
    encoded?: boolean;
    encodingType?: EncodingType;
    obfuscated?: boolean;
    staged?: boolean;
    platform?: 'windows' | 'linux' | 'macos' | 'universal';
}

export interface GeneratedShell {
    payload: string;
    language: ShellLanguage;
    type: ShellType;
    description: string;
    listener?: string;
    encoded?: boolean;
    raw?: string;
}

export interface EncodedPayload {
    original: string;
    encoded: string;
    encoding: EncodingType;
    iterations?: number;
    decoderStub?: string;
}

// Msfvenom types
export type MsfPayloadType = 
    | 'windows/meterpreter/reverse_tcp'
    | 'windows/meterpreter/reverse_https'
    | 'windows/x64/meterpreter/reverse_tcp'
    | 'windows/x64/meterpreter/reverse_https'
    | 'windows/shell/reverse_tcp'
    | 'windows/x64/shell/reverse_tcp'
    | 'linux/x86/meterpreter/reverse_tcp'
    | 'linux/x64/meterpreter/reverse_tcp'
    | 'linux/x86/shell/reverse_tcp'
    | 'linux/x64/shell/reverse_tcp'
    | 'php/meterpreter/reverse_tcp'
    | 'java/meterpreter/reverse_tcp'
    | 'python/meterpreter/reverse_tcp'
    | 'cmd/unix/reverse_bash'
    | 'cmd/unix/reverse_python'
    | 'cmd/unix/reverse_netcat'
    | 'cmd/windows/reverse_powershell';

export type MsfFormat = 
    | 'exe'
    | 'exe-small'
    | 'dll'
    | 'msi'
    | 'elf'
    | 'elf-so'
    | 'macho'
    | 'raw'
    | 'c'
    | 'csharp'
    | 'java'
    | 'python'
    | 'powershell'
    | 'psh'
    | 'psh-cmd'
    | 'psh-net'
    | 'bash'
    | 'sh'
    | 'perl'
    | 'ruby'
    | 'php'
    | 'asp'
    | 'aspx'
    | 'jsp'
    | 'war'
    | 'vba'
    | 'vbs'
    | 'hta';

export type MsfEncoder = 
    | 'x86/shikata_ga_nai'
    | 'x86/jmp_call_additive'
    | 'x86/call4_dword_xor'
    | 'x86/countdown'
    | 'x86/fnstenv_mov'
    | 'x64/xor'
    | 'x64/xor_dynamic'
    | 'cmd/powershell_base64'
    | 'php/base64'
    | 'ruby/base64';

export interface MsfvenomConfig {
    payload: MsfPayloadType | string;
    lhost: string;
    lport: number;
    format: MsfFormat;
    encoder?: MsfEncoder | string;
    iterations?: number;
    badchars?: string;
    nops?: number;
    platform?: string;
    arch?: string;
    template?: string;
    outputFile?: string;
}

export interface MsfvenomResult {
    success: boolean;
    command: string;
    output?: string;
    payload?: Uint8Array | string;
    error?: string;
    size?: number;
}

export interface PayloadTemplate {
    id: string;
    name: string;
    description: string;
    category: 'reverse_shell' | 'bind_shell' | 'web_shell' | 'meterpreter' | 'staged' | 'stageless';
    platform: 'windows' | 'linux' | 'macos' | 'web' | 'multi';
    config: Partial<MsfvenomConfig>;
}
